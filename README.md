# Unfazed Admin

åŸºäº Ant Design Pro æ„å»ºçš„ç°ä»£åŒ–ä¼ä¸šçº§ä¸­åå°ç®¡ç†ç³»ç»Ÿï¼Œä½¿ç”¨ React 18 + TypeScript + Umi 4 + Ant Design 5 æŠ€æœ¯æ ˆã€‚

## å¦‚ä½•ä½¿ç”¨

- éœ€è¦é…åˆ [Unfazed](https://github.com/unfazed-eco/unfazed) ä½¿ç”¨, å¦‚ä½•ä½¿ç”¨ Unfazed åˆ›å»º Web åç«¯é¡¹ç›®ï¼Œè¯·æŸ¥è¯¢ Unfazed ç›¸å…³æ–‡æ¡£

#### ä¸‹è½½ admin é™æ€æ–‡ä»¶

- åœ¨ [Unfazed Admin Release](https://github.com/unfazed-eco/unfazed-admin/releases) é¡µé¢è·å–æœ€æ–°çš„é™æ€æ–‡ä»¶
- æŠŠæ–‡ä»¶è§£å‹ï¼Œå¹¶ä¿®æ”¹æ–‡ä»¶åï¼ˆä¾‹å¦‚ï¼š`frontend`ï¼‰ï¼Œç„¶åæŠŠé™æ€æ–‡ä»¶æ”¾åˆ°é¡¹ç›®è·¯å¾„ä¸‹ï¼ˆä¾‹å¦‚ï¼š`UnfazedProject/src`ï¼‰

#### é…ç½®é™æ€æ–‡ä»¶è·¯ç”±

- æ‰“å¼€ `UnfazedProject/src/backend/routes.py`ï¼Œåœ¨æ ¹è·¯ç”±æ·»åŠ ä»¥ä¸‹é…ç½®
  - åœ°å€ä¸åšå¼ºåˆ¶è¦æ±‚ï¼Œè¯·æ ¹æ®å®é™…è·¯å¾„é…ç½®
  ```python
  static("/admin", directory="/var/www/src/frontend/", html=True)
  ```

#### å¦‚ä½•è®¿é—®

- æŠŠ Unfazed æœåŠ¡å¯åŠ¨åï¼Œåœ¨æµè§ˆå™¨è®¿é—® http://domain/admin/ å³å¯è®¿é—®

#### å¦‚ä½•é…ç½®åŠ¨æ€è·¯ç”±ï¼Œè¯·æŸ¥çœ‹ Unfazed Admin éƒ¨åˆ†çš„æ–‡æ¡£ï¼ˆå¾…æ›´æ–°ï¼‰

#### å¦‚ä½•ä¿®æ”¹ website name / logoï¼Œè¯·æŸ¥çœ‹ Unfazed Admin éƒ¨åˆ†çš„æ–‡æ¡£ï¼ˆå¾…æ›´æ–°ï¼‰

## å¦‚ä½•æŒ‡å®š è·¯ç”±å‰ç¼€
- é»˜è®¤æ˜¯ admin

- ä¿®æ”¹ è·¯ç”± å‰ç¼€
  ```shell
  # config/constants.ts
  ä¿®æ”¹ PATH_PREFIX è¿™ä¸ªå…¨å±€å˜é‡
  ```
- å®‰è£…ä¾èµ–
  ```shell
    cd unfazed-admin && npm install
  ```
- é‡æ–°æ‰“åŒ…
  ```shell
  npm run build
  ```

## å¦‚ä½•æ·»åŠ  æ–°çš„ components

### èƒŒæ™¯
- `ModelAdmin` æä¾›â€œåˆ—è¡¨ â‡„ è¯¦æƒ…â€åŒè§†å›¾æ§åˆ¶å™¨ï¼Œé€‚åˆå±•ç¤ºä¸ç®¡ç†æ•°æ®æ¨¡å‹ã€‚
- `ModelCustom` æä¾›â€œè¡¨å• + åŠ¨ä½œâ€æ¨¡æ¿ï¼Œé€‚åˆè¿è¡Œåç«¯è‡ªå®šä¹‰å·¥å…·æˆ–æ‰¹é‡æ“ä½œã€‚
- åŸºäºäºŒè€…å¯ä»¥å¿«é€Ÿå°è£…æ–°çš„ä¸šåŠ¡ç»„ä»¶ï¼Œä»¥ç»Ÿä¸€äº¤äº’ä½“éªŒå¹¶é™ä½é‡å¤å¼€å‘æˆæœ¬ã€‚

### åŸºç¡€ç»„ä»¶æ¦‚è§ˆ
- `ModelAdmin`ï¼šç»´æŠ¤è§†å›¾çŠ¶æ€ã€è®°å½•è¯¦æƒ…ï¼Œå¹¶å§”æ‰˜å®é™…æ¸²æŸ“ç»™ `ModelList` ä¸ `ModelDetail`ã€‚
  ```58:78:src/components/ModelAdmin/index.tsx
  return (
    <>
      {currentView === 'list' ? (
        <ModelList ... />
      ) : currentRecord && modelDesc ? (
        <ModelDetail ... />
      ) : (
        <div>Loading detail...</div>
      )}
    </>
  );
  ```
- `ModelCustom`ï¼šæŒ‰å·¥å…·æè¿°åŠ¨æ€ç”Ÿæˆè¡¨å•ï¼Œæ‰§è¡Œ `executeModelAction` å¹¶æ ¹æ®ä¸åŒè¾“å‡ºç±»å‹åé¦ˆç»“æœã€‚
  ```131:198:src/components/ModelCustom/index.tsx
  const response = await executeModelAction({
    name: toolName,
    action: actionKey,
    form_data: actionConfig.input === 'empty' ? {} : formData || {},
    search_condition: searchConditions,
  });
  ```

### è‡ªå®šä¹‰ç»„ä»¶æ­¥éª¤
1. **é€‰æ‹©æ¨¡æ¿**
   - åˆ—è¡¨/è¯¦æƒ…åœºæ™¯å¤åˆ¶ `ModelAdmin`ã€‚
   - è¡¨å•/å·¥å…·åœºæ™¯å¤åˆ¶ `ModelCustom`ã€‚
2. **é‡å‘½åä¸ç±»å‹**
   - ä¿®æ”¹æ–‡ä»¶ä¸ç»„ä»¶åç§°ï¼Œå®šä¹‰æ¸…æ™°çš„ Propsï¼ˆå¦‚ `modelName`ã€`toolName`ã€å›è°ƒå‡½æ•°ç­‰ï¼‰ã€‚
3. **é…ç½®æ•°æ®æº**
   - æ ¹æ®ä¸šåŠ¡è°ƒç”¨ `getModelDesc`ã€`executeModelAction` æˆ–è‡ªå®šä¹‰æ¥å£ã€‚
   - ä½¿ç”¨ `useRequest` æˆ– `useEffect` ç®¡ç†å¼‚æ­¥çŠ¶æ€ä¸ä¾èµ–åˆ·æ–°ã€‚
4. **æ¸²æŸ“ UI**
   - å¤ç”¨ `ModelList`ã€`ModelDetail` æˆ– `renderFormField`ï¼ŒæŒ‰éœ€è°ƒæ•´å¸ƒå±€ã€æ ¡éªŒã€æç¤ºã€‚
   - è‡ªå®šä¹‰æŒ‰é’®ã€æ“ä½œæç¤ºæ—¶å»ºè®®æ²¿ç”¨ Ant Design ç»„ä»¶ï¼ˆ`Button`ã€`Space`ã€`Modal` ç­‰ï¼‰ã€‚
5. **åŠ¨ä½œé€»è¾‘**
   - å‚è€ƒ `executeAction` å¤„ç†è¾“å…¥æ ¡éªŒã€è¯·æ±‚å‘é€ã€loading çŠ¶æ€ä¸æˆåŠŸ/å¤±è´¥æç¤ºã€‚
   - æ”¯æŒ `toast`ã€`display`ã€`download`ã€`refresh` ç­‰å¤šç±»å‹è¾“å‡ºï¼Œå¯è¿½åŠ è‡ªå®šä¹‰åˆ†æ”¯ã€‚
6. **å¯¼å‡ºä¸æ³¨å†Œ**
   - åœ¨ `src/components/index.ts`ï¼ˆæˆ–ç›¸å…³å…¥å£ï¼‰å¯¼å‡ºæ–°ç»„ä»¶ã€‚
   - åœ¨è·¯ç”±/èœå•é…ç½®ä¸­æ·»åŠ å…¥å£ï¼Œé¡µé¢å±‚å¼•å…¥å¹¶ä¼ é€’å¿…è¦ propsã€‚

### é›†æˆæ³¨æ„äº‹é¡¹
- å…±ç”¨å¸¸é‡æ”¾åœ¨ `config/constants`ï¼Œä¾‹å¦‚ `PATH_PREFIX`ï¼Œé¿å…ç›´æ¥ä¾èµ– `config/config` é»˜è®¤å¯¼å‡ºã€‚
- ç»„ä»¶è‹¥ä¾èµ–å›½é™…åŒ–æˆ–ä¸»é¢˜é…ç½®ï¼Œè¯·éµå¾ªç°æœ‰ä¸Šä¸‹æ–‡ï¼ˆ`@/locales`ã€`defaultSettings` ç­‰ï¼‰ã€‚
- ä¿æŒæ—¥å¿—æˆ–é”™è¯¯å¤„ç†è¯­å¥ç®€æ˜ï¼Œé¿å…åœ¨ç”Ÿäº§ç¯å¢ƒæ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

### éªŒè¯å»ºè®®
- ä½¿ç”¨ mock/åç«¯è”è°ƒé€æ­¥éªŒè¯ï¼šæè¿°åŠ è½½ã€è¡¨å•æ¸²æŸ“ã€åŠ¨ä½œæ‰§è¡Œã€æç¤ºåé¦ˆã€‚
- åœ¨è·¯ç”±é—´åˆ‡æ¢ï¼Œç¡®è®¤çŠ¶æ€é‡ç½®é€»è¾‘æœ‰æ•ˆï¼ˆå¦‚ `ModelAdmin` åœ¨ `modelName` å˜åŒ–æ—¶è¿˜åŸè§†å›¾ï¼‰ã€‚
- è¦†ç›–å¼‚å¸¸åœºæ™¯ï¼šç½‘ç»œé”™è¯¯ã€æ ¡éªŒå¤±è´¥ã€åç«¯æŠ¥é”™ç­‰ï¼Œç¡®ä¿ç•Œé¢æœ‰æ¸…æ™°åé¦ˆã€‚

### ç¤ºä¾‹æ‰©å±•æ–¹å‘
- åŸºäº `ModelAdmin`ï¼šæ–°å¢æ‰¹é‡æ“ä½œæŒ‰é’®ã€è¡Œå†…ç¼–è¾‘ã€ç­›é€‰æ¡ä»¶ç­‰ã€‚
- åŸºäº `ModelCustom`ï¼šå¢åŠ å¤šæ­¥éª¤è¡¨å•ã€åŠ¨ä½œæ‰§è¡Œæ—¥å¿—ã€ç»“æœå¯¼å‡ºæ ¼å¼é€‰æ‹©ç­‰ã€‚
- è‹¥éœ€è¦åŒæ—¶å…·å¤‡åˆ—è¡¨ä¸åŠ¨æ€è¡¨å•ï¼Œå¯ç»„åˆä¸¤è€…é€»è¾‘æˆ–æŠ½å–å…¬å…± hookã€‚

å®Œæˆä¸Šè¿°æ­¥éª¤åï¼Œå³å¯å¾—åˆ°ä¸€ä¸ªç¬¦åˆé¡¹ç›®è§„èŒƒçš„è‡ªå®šä¹‰ç»„ä»¶ï¼Œå¿«é€Ÿèå…¥ç°æœ‰ç®¡ç†åå°ã€‚


## å¦‚ä½•äºŒæ¬¡å¼€å‘

### ç¯å¢ƒè¦æ±‚

- Node.js >= 20.0.0
- npm æˆ– yarn æˆ– pnpm

### å®‰è£…ä¾èµ–

```bash
npm install
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm start
```

### ä»£ç æ£€æŸ¥

```bash
npm run lint
```

### é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ components/           # å…¨å±€ç»„ä»¶
â”œâ”€â”€ pages/               # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ user/           # ç”¨æˆ·ç›¸å…³é¡µé¢ï¼ˆç™»å½•ã€æ³¨å†Œï¼‰
â”‚   â”œâ”€â”€ exception/      # å¼‚å¸¸é¡µé¢ï¼ˆ403ã€404ã€500ï¼‰
â”‚   â”œâ”€â”€ result/         # ç»“æœé¡µé¢ï¼ˆæˆåŠŸã€å¤±è´¥ï¼‰
â”‚   â””â”€â”€ Admin.tsx       # ç®¡ç†é¡µé¢
â”œâ”€â”€ services/           # API æœåŠ¡
â”œâ”€â”€ locales/           # å›½é™…åŒ–æ–‡ä»¶
â””â”€â”€ app.tsx            # åº”ç”¨å…¥å£é…ç½®
```

### æ·»åŠ æ–°é¡µé¢

1. åœ¨ `src/pages/` ç›®å½•ä¸‹åˆ›å»ºæ–°çš„é¡µé¢ç»„ä»¶
2. åœ¨ `config/routes.ts` ä¸­æ·»åŠ è·¯ç”±é…ç½®
3. å¦‚éœ€æƒé™æ§åˆ¶ï¼Œåœ¨ `src/access.ts` ä¸­é…ç½®æƒé™

### æ·»åŠ æ–°æ¥å£

1. åœ¨ `src/services/api.ts` ä¸­æ·»åŠ æ–°çš„ API æ¥å£
2. ä½¿ç”¨ TypeScript å®šä¹‰æ¥å£ç±»å‹
3. åœ¨é¡µé¢ç»„ä»¶ä¸­è°ƒç”¨æ¥å£

### å›½é™…åŒ–

1. åœ¨ `src/locales/zh-CN/` å’Œ `src/locales/en-US/` ä¸­æ·»åŠ ç¿»è¯‘æ–‡ä»¶
2. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ `useIntl()` æˆ– `formatMessage()` è¿›è¡Œå›½é™…åŒ–

### ä¸»é¢˜å®šåˆ¶

åœ¨ `config/defaultSettings.ts` ä¸­ä¿®æ”¹ä¸»é¢˜é…ç½®ï¼Œæ”¯æŒï¼š

- ä¸»è‰²è°ƒé…ç½®
- å¸ƒå±€æ¨¡å¼ï¼ˆä¾§è¾¹æ ã€é¡¶éƒ¨å¯¼èˆªç­‰ï¼‰
- æš—é»‘æ¨¡å¼åˆ‡æ¢

### ä»£ç†é…ç½®

å¼€å‘ç¯å¢ƒä»£ç†é…ç½®ä½äº `config/proxy.ts`ï¼Œå¯ä»¥é…ç½® API ä»£ç†ã€‚

### å›½é™…åŒ–é…ç½®

å›½é™…åŒ–æ–‡ä»¶ä½äº `src/locales/` ç›®å½•ï¼Œæ”¯æŒå¤šè¯­è¨€åˆ‡æ¢ã€‚

## ğŸ“– æ›´å¤šæ–‡æ¡£

- [Ant Design Pro å®˜æ–¹æ–‡æ¡£](https://pro.ant.design/)
- [Umi å®˜æ–¹æ–‡æ¡£](https://umijs.org/)
- [Ant Design å®˜æ–¹æ–‡æ¡£](https://ant.design/)

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿›é¡¹ç›®ã€‚

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº MIT è®¸å¯è¯å¼€æºã€‚
